# 腰椎圧迫骨折の検出をする CNN

腰部レントゲンの正面像と側面像を入力として、腰椎新鮮圧迫骨折の有無を分類する CNN です。VGG16 を fine tuning しています。

## 使用技術

言語・ライブラリー：Python, Numpy, Scikit-learn

前処理：cv2

CNN： Keras, Tensorflow, VGG16

描画：Matplotlib, Seaborn

## 流れ

### 前処理

正面像および側面像をグレースケールに変更。その後 400px x 300px に resize したのちに正規化。

### 学習

VGG16 を転移学習。VGG16 のモデルを２つ用意する。正面像、側面像をそれぞれ別の VGG16 に学習させる(CNN)。

その後 1 次ベクトルに変換後に結合し、ノード数 32 で 3 層の全結合層に通す(Deep learning)。

### 出力

最終層で Sigmoid 活性化関数を用いて骨折の確率を計算。0.5 以上のものを骨折ありと判定する。

## TODO

- [ ] 過学習の修正
  - [ ] パラメーターを減らす。
  - [ ] L2 正則化
  - [ ] Dropout 実装
- [ ] 椎体のみを検出する前処理
- [ ] 年齢・性別など他の因子も入力できる様にする。

## Issue

- そもそも陳旧性骨折が非骨折群に存在しない。
- そもそも正面像と側面像を組み合わせるのが医学的に有意義か不明。実臨床的には側面像の座位と臥位を組み合わせて、椎体の不安定性を見た方が診断率が高い。
